apiVersion: batch/v1
kind: CronJob
metadata:
  name: ripeness-rollup
  namespace: vectordb
spec:
  schedule: "0 3 * * 1"   # כל יום שני 03:00
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: ripeness
            image: YOUR_REGISTRY/ripeness-baseline:latest
            env:
            - name: PGHOST
              valueFrom: { secretKeyRef: { name: pg-secret, key: host } }
            - name: PGPORT
              value: "5432"
            - name: PGDATABASE
              valueFrom: { secretKeyRef: { name: pg-secret, key: db } }
            - name: PGUSER
              valueFrom: { secretKeyRef: { name: pg-secret, key: user } }
            - name: PGPASSWORD
              valueFrom: { secretKeyRef: { name: pg-secret, key: password } }
            - name: SAMPLES_DIR
              value: "/app/samples"
            - name: FRUIT_TYPE
              value: "apple"
          restartPolicy: OnFailure
